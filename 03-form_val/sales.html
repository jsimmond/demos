<html>
	<head>
		<title>Validando formularios</title>
		<meta charset="utf-8">
	</head>

	<body>
		<form id="venta" name="simpleForm" action="http://localhost:8000/cgi-bin/make_sale.py" method="post" reset>
			<fieldset>
				<legend>Datos del cliente:</legend>
				Nombre: <input type="text" id="nombre"><br>
				Telefono: <input type="text" id="correo"><br>
			</fieldset>
			<fieldset>
				<legend>Datos de la compra:</legend>
				<table id="table"><tr><th>Item</th><th>Cantidad</th><th>Precio unitario</th><th>Subtotal</th></tr>
					<tr id="item0"><td><input type="text" name="name0"></td>
						<td><input type="text" name="cant0" id="cant0" onblur="updateTot(0)"></td>
						<td><input type="text" name="prec0" id="prec0" onblur="updateTot(0)"></td>
						<td><input type="text" id="sub0" disabled></td></tr>
				</table>
			<input type="reset" value="Limpiar formulario"/>
			<button onclick="addRow();return false;">Agregar item</button>
			<input type="submit" value="Enviar!">
			</fieldset>
			<fieldset>
				<legend>Total compra:</legend>
				<input type="text" id="total" disabled value="0">
			</fieldset>
	</form>

	<script>
var n = 0;
function addRow(){
//	console.clear();
	++n;
	let newRow = '<tr id="item' + n + '"><td><input type="text" name="name' + n + '"></td><td><input type="text" name="cant' + n +'" id="cant' + n +'" onblur="updateTot('+ n +')"></td><td><input type="text" name="prec' + n + '" id="prec' + n + '" onblur="updateTot(' + n +')"></td><td><input type="text" id="sub' + n + '" disabled></td></tr>';
//	console.log(newRow);
	table.insertAdjacentHTML('beforeend', newRow);
}

function updateTot(val){
//	console.log(val);
	let cant = document.getElementById(`cant${val}`);
	let prec = document.getElementById(`prec${val}`);
	let mult = +cant.value * +prec.value;
//	console.log(mult);
	let sub = document.getElementById(`sub${val}`);
	sub.value = mult;
	total.value = +total.value + mult;	
}

	</script>
 
	</body>
</html>
